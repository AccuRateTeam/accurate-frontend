<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPArchery</title>
  </head>

  <link rel="stylesheet" href="stylesheets/login.css">

  <script src = "/js/accurate-sdk.min.js">

  </script>
  <body>
    <h3 id = "user_name">
    </h3>
    <button id = "btn_in">
      login
    </button>
    <button id = "btn_out">
      logout
    </button>

    

    <script>
      window.onload = async function(){
        const authClient = await Accurate.AuthClient.create('dev-i0-rmfoq.us.auth0.com', 'KaYkcJboWxnPEmiHqcmI6Ka1YdqhS8L3', 'https://www.accurate.com/');
        
        // login button
        document.getElementById("btn_in").onclick = async function(){await authClient.authorize('http://localhost:3000');}

        // logout button
        document.getElementById("btn_out").onclick = async function(){await authClient.logout('http://localhost:3000');}

        // check if user is logged in 
        if(await authClient.isAuthenticated()){
          const apiClient = await Accurate.ApiClient.create('http://localhost:5000', await authClient.getAccessToken());

          // todo: user laden und nicht createn
          // const user = await apiClient.user.create({
          //   user_name : "zmoa",
          //   user_email : "a.ranzmaier@gmail.com"
          // });

          var user = await apiClient.user.me();
          document.getElementById("user_name").innerHTML = user.user_name;
        }
      }
    </script>
  </body>
</html>